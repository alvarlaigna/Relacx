/*!
 * Relacx v2.0
 *
 * Copyright 2017, Himanshu Tanwar
 * Released under the MIT license
 * https://github.com/webXtended/Relacx
 * Date: 2017-09-19
 */
"use strict";!function(t,e,o){"undefined"!=typeof module?module.exports=o():"function"==typeof define?define(o):e[t]=o()}("Relacx",window,function(){function t(t,e,o){for(var n,e=e.split("."),r=t,s=1;s<e.length-1;s++)n=e[s],r=r[n];return r[e.pop()]=o,t}function e(){function e(e,o){var n=this,r=[];this.childKeys="root",this.componentController=o,this.constructor.prototype=o,this.action=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var o=Function.prototype.bind.apply(this.componentController[t],[n].concat(e));return o},this.setState=function(o,n){if(n){var r=t(e.state,n,o);r=JSON.parse(JSON.stringify(r)),e.setState(r)}else e.setState(o)},this.getState=function(){return e.state},this.getChildInstances=function(){return r},this.addChildInstance=function(t){r.push(t)}}return e}function o(t,e){function o(o,n){var r=this,s=e;this.childKeys=e,this.componentController=n,this.action=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var o=Function.prototype.bind.apply(this.componentController[t],[r].concat(e));return o},this.setState=function(e,o){var n=t.props.controller.childKeys;t.props.controller.setState(e,[n,o||s].join("."))},this.getState=function(){return o.state}}return o}function n(t,o,n){var r=e(),s=(a[t.name]||{},React.createElement(l,{init:r,comp:t,props:n.props,state:n.state,callback:n.callback}));return o?void ReactDOM.render(s,o):s}function r(t,n){n=n||{},n.props=n.props||{},n.state=n.state||{};var r=a[t.name]||{},s=n.parent&&n.childPath?o(n.parent,n.childPath):e(),i=React.createElement(l,{init:s,comp:t,compController:r,key:n.key,props:n.props,state:n.state});return i}function s(t){if(t){var e=t.name,o=new i(e);return a[e]=o,o}return!1}function i(t){this.componentName=t}function p(t,e){for(var o=c[t],n=0;n<o.length;n++){var r=a[o[n].componentName];o[n].action.call(r.componentController,t,e)}}var a={},c={},l=function(t){function e(t){babelHelpers.classCallCheck(this,e);var o=babelHelpers.possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n={};for(var r in o.props.props)n[r]=o.props.props[r];return o.properties=n,o}return babelHelpers.inherits(e,t),babelHelpers.createClass(e,[{key:"componentWillMount",value:function(){this.props.parentController&&(this.props.init.prototype.uber=this.props.parentController);var t=new this.props.init(this,this.props.compController);this.controller=t,this.setState(this.props.state),a[this.props.comp.name]&&a[this.props.comp.name].setComponentController(t),this.props.callback&&this.props.callback(t)}},{key:"componentWillReceiveProps",value:function(t){this.setState(t.state)}},{key:"render",value:function(){var t=this.props.comp;return this.properties.controller=this.controller,this.properties.state=this.state,React.createElement(t,this.properties)}}]),e}(React.Component);return i.prototype.setComponentController=function(t){this.componentController=t},i.prototype.addAction=function(t,e){this[t]=e},i.prototype.addActionListener=function(t,e){if(t&&"string"==typeof t)c[t]=c[t]||[],c[t].push({componentName:this.componentName,action:e});else if(t&&t.length)for(var o=0;o<t.length;o++)c[t[o]]=c[t[o]]||[],c[t[o]].push({componentName:this.componentName,action:e})},i.prototype.addBroadcastAction=function(t,e){this[t]=function(){var o=Array.prototype.slice.call(arguments),n=e.apply(this,o);p(t,n)}},{render:n,component:r,controller:s,broadcastAction:p}});
